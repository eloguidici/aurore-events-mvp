# Server Configuration (REQUIRED)
PORT=3000
HOST=localhost
NODE_ENV=development

# Database Configuration (REQUIRED - PostgreSQL only)
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=admin
DB_PASSWORD=admin
DB_DATABASE=aurore_events

# Common Database Configuration
DB_SYNCHRONIZE=true
DB_LOGGING=false

# Batch Worker Configuration (REQUIRED)
# Para 5,000 eventos/segundo: BATCH_SIZE=5000 y DRAIN_INTERVAL=1000
# O alternativamente: BATCH_SIZE=500 y DRAIN_INTERVAL=100
BATCH_SIZE=5000
DRAIN_INTERVAL=1000
MAX_RETRIES=3
# Maximum batch size to prevent memory issues (range: 1000-100000)
# Hard limit for batch processing to prevent excessive memory usage
BATCH_MAX_SIZE=10000

# Buffer Configuration (REQUIRED)
# Buffer m√°s grande para absorber picos de 5,000 eventos/segundo
BUFFER_MAX_SIZE=50000
CHECKPOINT_INTERVAL_MS=5000

# Retention Configuration (REQUIRED)
RETENTION_DAYS=30
RETENTION_CRON_SCHEDULE=0 2 * * *

# Query Configuration (REQUIRED)
DEFAULT_QUERY_LIMIT=100
MAX_QUERY_LIMIT=1000
# Maximum time range in days for queries (range: 1-365, default: 30)
# Prevents queries that span too long a time period
MAX_QUERY_TIME_RANGE_DAYS=30
# Query timeout in milliseconds (range: 1000-300000)
# Maximum time to wait for a query to complete before timing out
QUERY_TIMEOUT_MS=30000
# Maximum page number for pagination (range: 100-100000)
# Prevents excessive offsets that could cause performance issues
MAX_QUERY_PAGE=10000

# Service Configuration (REQUIRED)
SERVICE_NAME_MAX_LENGTH=100
RETRY_AFTER_SECONDS=5

# Validation Configuration (REQUIRED)
MESSAGE_MAX_LENGTH=2000
METADATA_MAX_SIZE_KB=16
BATCH_CHUNK_SIZE=1000
# Maximum number of keys in metadata object (range: 10-1000)
# Prevents performance issues with very large metadata objects
METADATA_MAX_KEYS=100
# Maximum nesting depth for metadata object (range: 2-10)
# Prevents deeply nested objects that could cause stack overflow
METADATA_MAX_DEPTH=5

# Circuit Breaker Configuration (REQUIRED)
# Number of failures before opening circuit (range: 1-20)
# When circuit is OPEN, database operations are rejected immediately
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5

# Number of successes in HALF_OPEN state to close circuit (range: 1-10)
# Circuit moves to HALF_OPEN after timeout to test if service recovered
CIRCUIT_BREAKER_SUCCESS_THRESHOLD=2

# Time to wait before trying HALF_OPEN state in milliseconds (range: 1000-300000)
# After this timeout, circuit moves from OPEN to HALF_OPEN to test recovery
CIRCUIT_BREAKER_TIMEOUT_MS=30000

# Shutdown Configuration (REQUIRED)
# Maximum time to wait for graceful shutdown in milliseconds (range: 5000-300000)
# Batch worker will process remaining events in buffer during shutdown
# If timeout is reached, shutdown continues even if events remain
SHUTDOWN_TIMEOUT_MS=30000

# Metrics Configuration (REQUIRED)
# Default limit for metrics history queries (range: 10-1000)
# Used when querying historical metrics snapshots
METRICS_HISTORY_DEFAULT_LIMIT=100

# Rate Limiting Configuration (REQUIRED)
# Time window for rate limiting in milliseconds (range: 1000-3600000)
# All rate limits use this time window
THROTTLE_TTL_MS=60000

# Global request limit per time window (range: 1000-1000000)
# Total requests allowed across all IPs in the time window
# For 5,000 events/second: 300,000 requests/minute = 5,000/second
THROTTLE_GLOBAL_LIMIT=300000

# Per-IP request limit per time window (range: 100-100000)
# Maximum requests allowed per IP address in the time window
# Prevents abuse from single IP addresses
THROTTLE_IP_LIMIT=10000

# Query endpoint rate limit per time window (range: 10-10000)
# Maximum requests allowed for GET /events endpoint per time window
THROTTLE_QUERY_LIMIT=200

# Health check endpoint rate limit per time window (range: 10-1000)
# Maximum requests allowed for health check endpoints per time window
THROTTLE_HEALTH_LIMIT=60

# Database Connection Pool Configuration (REQUIRED)
# Maximum number of connections in the PostgreSQL connection pool (range: 5-100)
# Higher values allow more concurrent database operations but consume more resources
DB_POOL_MAX=20

